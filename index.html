<!doctype html>
<html lang="en">
  <head>
    <title>React App Test</title>
    <link rel="stylesheet" href="src/index.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
     integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
     crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
     integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
     crossorigin=""></script>
  </head>
  <body>
    <div class="container" id="nav-link">
      <button id="nav-title">Vigil AI</button>
      <div id="empty"></div>
      <button id="nav-btn">Report</button>
      <button id="nav-btn">Call for help</button>
      <button id="nav-btn">News</button>
      <button id="nav-btn">More</button>
    </div>
    <div id="meow"></div>
    <div id="err"></div>
    <div id="map"></div>
    <div id="woof"></div>
    <script type="module" src="/src/main.jsx"></script>
  </body>

  <script>

    var map = L.map('map');
    map.setView([5.518, 116.768], 13);

    L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19,
    attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
    }).addTo(map);

    // Get the user's location
    navigator.geolocation.watchPosition(success, error);

    let marker, circle;

    function success(pos) {

      const lat = pos.coords.latitude;
      const lng = pos.coords.longitude;
      const acc = pos.coords.accuracy;
      console.log(lat);
      console.log(lng);

      // Remove the marker and circle if the user moves
      if (marker) {
        map.removeLayer(marker);
        map.removeLayer(circle);
      }

      marker = L.marker([lat,lng]).addTo(map);
      circle = L.circle([lat,lng], {radius: acc}).addTo(map);

      map.fitBounds(circle.getBounds());
    }

    function error(err) {

      // User refused access
      if (err.code == 1) {
        alert("Please allow geolocation access.");
      } else {
        alert("Cannot get current user location.");
      }
    }

  </script>
</html>